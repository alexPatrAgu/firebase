<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRODUCTOS</title>
</head>
<body>
    <ul>
        <li><a href="index.html">Inicio</a></li>
        <li><a href="productos.html">Productos</a></li>
        <li><a href="#">Servicios</a></li>
        <li><a href="#">Contacto</a></li>
    </ul>
    <h1>Insertar producto</h1>
    <form id="productos">
        <input type="text" id="nombre" placeholder="INSERTA EL NOMBRE DEL ESTUDIANTE">
        <input type="text" id="apellido" placeholder="INSERTAR EL APELLIDO DEL ESTUDIANTE">
        <button type="submit">Agregar</button>
    </form>

    <h2>Lista de alumnos</h2>
    <ul id="lista-alumno"></ul>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

        // ConfiguraciÃ³n de Firebase
        // Your web app's Firebase configuration
        const firebaseConfig = {
        apiKey: "AIzaSyAkV8sXa7n5qe6luXOtcxHhgdd1_EjX04s",
        authDomain: "usuario-a1979.firebaseapp.com",
        projectId: "usuario-a1979",
        storageBucket: "usuario-a1979.appspot.com",
        messagingSenderId: "515804654653",
        appId: "1:515804654653:web:90bfd1725d1eddd1b48e54"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const listaAlumno = document.getElementById("lista-alumno");

        function renderAlumno(querySnapshot) {
            listaAlumno.innerHTML = "";
            querySnapshot.forEach(doc => {
                const alumno = doc.data();
                const li = document.createElement("li");
                li.textContent = `${alumno.nombre} - ${alumno.apellido}`;
                const btnEliminar = document.createElement("button");
                btnEliminar.textContent = "Eliminar";
                btnEliminar.addEventListener("click", () => {
                    eliminarAlumno(doc.id);
                });
                const btnModificar = document.createElement("button");
                btnModificar.textContent = "Modificar";
                btnModificar.addEventListener("click", () => {
                    modificarAlumno(doc.id, alumno.nombre, alumno.apellido);
                });
                li.appendChild(btnEliminar);
                li.appendChild(btnModificar);
                listaAlumno.appendChild(li);
            });
        }

        onSnapshot(collection(db, "alumno"), renderAlumno);

        const alumnoForm = document.getElementById("alumno");
        alumnoForm.addEventListener("submit", async(e) => {
            e.preventDefault();
            await addDoc(collection(db, "alumno"), {
                nombre: alumnoForm.nombre.value,
                apellido: alumnoForm.apellido.value
            });
            alumnoForm.reset();
        });

        async function eliminarAlumno(id) {
            try {
                await deleteDoc(doc(db, "alumno", id));
            } catch (error) {
                console.error("Error al eliminar el producto:", error);
            }
        }

        async function modificarAlumno(id, nombreActual, apellidoActual) {
            const nuevoNombre = prompt("Ingrese el nuevo nombre:", nombreActual);
            const nuevoApellido = prompt("Ingrese el nuevo apellido:", apellidoActual);
            if (nuevoNombre !== null && nuevoApellido !== null) {
                try {
                    await updateDoc(doc(db, "nombre", id), {
                        nombre: nuevoNombre,
                        apellido: nuevoApellido
                    });
                } catch (error) {
                    console.error("Error al modificar el producto:", error);
                }
            }
        }
    </script>
</body>
</html>