<html>
    <!--TITULO DE PAGINA-->
    <head>
        <title>INGRESO DATOS FORMULARIO</title> 
        <!--APLICACION DE CSS-->
        <link href="css/menu.css" rel="stylesheet">
        <link href="css/estyle2.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet">
        <link href="css/formulario.css" rel="stylesheet">
        <link href="css/cuerpo.css" rel="stylesheet">
    </head>
        <!--COLOR DEL CUERPO DE LA PAGINA-->
    <body bgcolor="#FFFFFF">
        <!--TABLA PRINCIPAL-->
        <!--Centra; color-->
        <table border="0" width="95%" align="center" bgcolor="#0B73F8" class="tabla_1" padding="auto">
            <!--Tabla menú opciones_1-->
            <tr>
                <td colspan="8" >
                    <table>
                    <tr>
                        <!--Menu desplegable con listas-->
                        <header>
                            <nav class="navegacion">
                                <ul  align="center" class="menu">
                                    <li><a href="formulario.html"><h3>BASE DE DATOS</h3></a>
                                </ul>
                            </nav>
                        </header>
                    </tr> 
                    </table>      
                </td>
            </tr>
            <!--TABLA_2--> 
            <tr>
                <td colspan="2">&nbsp;</td>
            </tr>
            <!--FORMULARIO--> 
            <tr>
                <td colspan="1" class="tabla_1" align="center">           
                    <section class="formulario_1">
                        <img src="imagenes/Formulario_Imag.jpeg" class="imagen_formulario">
                        <br>
                        <br>
                        <h4 align="justify" class="parrafos"> "POR EL BIENESTAR DE LA SOCIEDAD, CREANDO LIDERES Y OBRADORES DE LA EFICACIA PARA QUE PUEDAN CAMBIAR EL MUNDO!" </h4>
                        <h4 align="center">Bienvenido/a</h4>
                        <h4 align="center">Ingresa tus datos</h4>
                        <form id="formulario">
                            <input class="controles" type="text" id="email" placeholder="INSERTA EL E-MAIL">
                            <input class="controles" type="text" id="contraseña" placeholder="INSERTAR LA CONTRASEÑA">
                            <button class="botones" type="button" id="iniciar_sesion">Iniciar sesion</button>
                            <button class="botones" type="button" id="registrarse">registrarse</button>
                            <button class="botones" type="button" id="sesion_google">Iniciar sesion con google</button>
                        </form>                      
                        
                    </section>
                </td>
            </tr>
            <!--TABLA PIE DEL DISEÑO-->
            <tr>
                <td colspan="2">&nbsp;</td>
            </tr>
        </table>
        <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-app.js";
            import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-auth.js";
    
            // Your web app's Firebase configuration
            const firebaseConfig = {
                apiKey: "AIzaSyAkV8sXa7n5qe6luXOtcxHhgdd1_EjX04s",
                authDomain: "usuario-a1979.firebaseapp.com",
                projectId: "usuario-a1979",
                storageBucket: "usuario-a1979.appspot.com",
                messagingSenderId: "515804654653",
                appId: "1:515804654653:web:90bfd1725d1eddd1b48e54"
            };

    
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
    
            // Initialize Google Auth provider
            const provider = new GoogleAuthProvider();
    
            document.addEventListener('DOMContentLoaded', () => {
                const authformulario = document.getElementById('formulario');
                const email = document.getElementById('email');
                const contraseña = document.getElementById('contraseña');
                const iniciar_sesion = document.getElementById('iniciar_sesion');
                const resgitrarse = document.getElementById('registrarse');
                const sesion_google = document.getElementById('sesion_google');

                //CAMBIO
                // Iniciar sesion email
                iniciar_sesion.addEventListener('click', (e) => {
                    e.preventDefault();
                    const email = email.value;
                    const contraseña = contraseña.value;
    
                    signInWithEmailAndPassword(auth, email , contraseña)
                        .then((userCredential) => {
                            const user = userCredential.user;
                            console.log('Usuario ingresado:', user);
                            // Redirigir a pacientes.html
                            window.location.href = 'index.html';
                        })
                        .catch((error) => {
                            console.error('Error durante la autenticación:', error);
                            alert(`Error: ${error.message}`);
                        });
                });
                //CAMBIO
    
                // Registrar sesion email
                registrarse.addEventListener('click', (e) => {
                    e.preventDefault();
                    const email = email.value;
                    const contraseña = contraseña.value;
    
                    createUserWithEmailAndPassword(auth, email, contraseña)
                        .then((userCredential) => {
                            const user = userCredential.user;
                            console.log('Usuario registrado:', user);
                            
                        })
                        .catch((error) => {
                            console.error('Error durante el registro:', error);
                            alert(`Error: ${error.message}`);
                        });
                });
    
                // Google login functionality
                sesion_google.addEventListener('click', (e) => {
                    e.preventDefault();
                    signInWithPopup(auth, provider)
                        .then((result) => {
                            const user = result.user;
                            console.log('Usuario ingresado con Google:', user);
                            // Redirigir a pacientes.html
                            window.location.href = 'index.html';
                        })
                        .catch((error) => {
                            console.error('Error durante la autenticación con Google:', error);
                            alert(`Error: ${error.message}`);
                        });
                });
            });
        </script>

    </body>
</html>